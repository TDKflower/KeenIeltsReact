import{j as e,h as se,a as M,b as x,k as B,c as l,y as te,z as ne,r as n,i as oe,g as ie,u as ae,A as re,S as le,G as ce,e as de}from"./index-de900e16.js";import{M as ue}from"./MiniNavBar-baed3ede.js";import{C as me}from"./CountdownTimer-6ba890f2.js";import{Q as xe,g as he}from"./QuestionPallete-da778278.js";import{F as pe}from"./FontSizeSlider-d03d9414.js";import{R as fe,a as je}from"./ReadingPassage-4311597f.js";import{B as we}from"./BookInfo-e84fe088.js";import{C as ge}from"./CustomSplitPane-6256b20f.js";import{M as a}from"./Modal-a2fdd4fc.js";import{T as Se}from"./Table-7167a013.js";import"./ButtonGroup-fcd12b84.js";import"./ParseQuestions-9e61f52b.js";const be=({isExpanded:d,toggleExpanded:f,deviceType:h,module:j,questionData:w,setShowReviewModal:u,userAllAnswer:t,setShowSubmitModal:g,handleConfirmEndTest:o})=>e.jsx("div",{className:"fixed-footer border-top",style:{height:d?"50vh":"50px",width:"100vw",position:"fixed",bottom:0,backgroundColor:"white",transition:"height 0.3s",zIndex:"999"},children:e.jsxs(se,{children:[e.jsxs(M,{className:"mt-1 pb-1 border-bottom text-black",children:[e.jsx(x,{className:"col-3 mt-1",children:e.jsx("div",{children:e.jsxs("span",{style:{fontSize:"20px"},children:[e.jsx(B,{className:"",style:{marginRight:"5px"}}),w.completed_questions,"/",j.total_questions]})})}),e.jsx(x,{className:"col-3 text-center mt-1",children:e.jsx(me,{initialMinutes:60,initialSeconds:0,handleTimesUp:o})}),e.jsx(x,{className:"col-3 mt-1",children:h!=="mobile"&&e.jsx(pe,{})}),e.jsxs(x,{className:"col-3",style:{textAlign:"right"},children:[h!=="mobile"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:()=>{u(!0)},children:"Review"}),e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:g,children:"Submit Test"})]}),e.jsx(l,{className:"mx-1",onClick:()=>f(!d),children:d?e.jsx(te,{size:20}):e.jsx(ne,{size:20})})]})]}),e.jsxs(M,{className:"my-3",style:{overflow:"auto",maxHeight:"38vh"},children:[e.jsxs(x,{lg:"8",className:"my-2",children:[e.jsx("p",{className:" fw-bold text-black mb-1 mx-1",children:"Question Pallete"}),e.jsx(xe,{module:j,currentFormData:t})]}),e.jsx(x,{lg:"4",children:h==="mobile"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:()=>{u(!0)},children:"Review"}),e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:g,children:"Submit Test"})]})})]})]})}),ze=()=>{const[d,f]=n.useState("desktop"),[h,j]=n.useState(!1),{module_slug:w,attempt_slug:u}=oe(),[t,g]=n.useState(null),[o,m]=n.useState(null),[ve,E]=n.useState({}),[c,z]=n.useState({}),[_,P]=n.useState(null),[p,y]=n.useState({}),[D,U]=n.useState({completed_questions:0}),[q,C]=n.useState(!1),N=()=>C(!1),[H,k]=n.useState(!1),A=()=>k(!1),R=n.useRef(null),F=ie(),[L,S]=n.useState(!1),b=()=>S(!1),Q=ae();n.useRef(null),n.useRef(null);const O=o?o.id===t.sections[0].id:!1,Y=o?o.id===t.sections[t.sections.length-1].id:!1;n.useEffect(()=>{J()},[]),n.useEffect(()=>{if(o){const s=c[o.id];P(s),window.scrollTo(0,0)}},[o]),n.useEffect(()=>{const s=()=>{window.innerWidth<768?f("mobile"):f("desktop")};return s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),n.useEffect(()=>{v(),V()},[t]),n.useEffect(()=>{if(c){let s=0;Object.keys(c).map(i=>Object.keys(c[i]).map(r=>c[i][r]!==void 0&&c[i][r]!==""&&s++)),U({completed_questions:s})}},[c]);function v(){if(o!=null){const s=he(R,t,E);return z({...c,[o.id]:s}),y({...p,...s}),s}else return null}const $=s=>{s.preventDefault(),Z()},G=s=>{v()};function K(){const i=t.sections.findIndex(r=>r.id===o.id)-1;i>=0?m(t.sections[i]):m(t.sections[t.sections.length-1])}function W(){const i=t.sections.findIndex(r=>r.id===o.id)+1;i<t.sections.length?m(t.sections[i]):m(t.sections[0])}async function J(){const s=await F.post(re.getReadingModule+w+"/");s.status===200&&(g(s.data),m(s.data.sections[0]))}function T(s){const i=t.sections.find(r=>r.id===s);m(i)}function V(){if(t){const s=t.total_questions;let i={};Array.from({length:s},(r,ee)=>ee+1).map(r=>i["que-"+r]=""),y(i)}}function X(s="In Progress"){const i={answers:p,attempt_type:s};return F.post("/ieltstest/update_attempt/reading/"+u+"/",i)}function Z(){handleShowModal()}function I(){v(),X("Completed").then(s=>{s.status===200&&(console.log("Attempt Updated"),Q(`/ieltstest/attempt/reading/${w}/${u}/get_result`))}).catch(s=>{console.error("Error updating attempt: ",s)}),b()}return n.useEffect(()=>{document.title="Reading Test | KeenIELTS"},[]),t?e.jsxs(e.Fragment,{children:[e.jsx(ue,{module:t,currentSection:o,updateCurrentSection:T,setShowTestInfoModal:k}),e.jsx(ge,{deviceType:d,currentSection:o,left:e.jsx(e.Fragment,{children:e.jsx(fe,{section:o})}),right:e.jsxs(e.Fragment,{children:[e.jsx(je,{section:o,handleChange:G,handleSubmit:$,formRef:R,section_form_values:_},o.id),e.jsxs(le,{direction:"horizontal",className:"border-top pt-3",children:[e.jsx("div",{className:"m-0",children:e.jsxs(l,{variant:"dark",className:"btn-sm",onClick:K,disabled:O,children:[e.jsx(ce,{size:20})," Previous Section"]})}),e.jsx("div",{className:"m-0 ms-auto",children:Y?e.jsxs(l,{variant:"primary",className:"btn-sm",onClick:()=>{S(!0)},children:["Submit Test ",e.jsx(B,{size:20})]}):e.jsxs(l,{variant:"dark",className:"btn-sm",onClick:W,children:["Next Section ",e.jsx(de,{size:20})]})})]})]})}),e.jsx(be,{isExpanded:h,toggleExpanded:j,deviceType:d,module:t,updateCurrentSection:T,questionData:D,setShowReviewModal:C,userAllAnswer:p,setShowSubmitModal:S,handleConfirmEndTest:I}),e.jsxs(a,{show:L,onHide:b,centered:!0,children:[e.jsx(a.Header,{closeButton:!0,children:e.jsx(a.Title,{children:"End Test"})}),e.jsx(a.Body,{children:"Are you sure you want to end the test?"}),e.jsxs(a.Footer,{className:"p-2",children:[e.jsx(l,{variant:"outline-primary",onClick:b,children:"No"}),e.jsx(l,{variant:"primary",onClick:I,children:"Yes, end test"})]})]}),e.jsxs(a,{show:q,onHide:N,centered:!0,className:"p-0",children:[e.jsx(a.Header,{closeButton:!0,children:e.jsx(a.Title,{children:"Review Answers"})}),e.jsx(a.Body,{children:e.jsxs(Se,{striped:!0,bordered:!0,size:"sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Your Answer"})]})}),e.jsx("tbody",{children:Object.keys(p).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.split("-")[1]}),e.jsx("td",{className:"fw-bold text-black",children:p[s]})]},s))})]})}),e.jsx("div",{class:"modal-footer py-2",children:e.jsx("button",{type:"button",class:"btn btn-outline-primary",onClick:N,children:"Close"})})]}),e.jsxs(a,{show:H,onHide:A,centered:!0,className:"p-0",children:[e.jsx(a.Header,{closeButton:!0,children:e.jsx(a.Title,{children:"Test Info"})}),e.jsx(a.Body,{className:"p-0",children:e.jsx(we,{module:t,attempt_slug:u})}),e.jsx("div",{className:"modal-footer py-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:A,children:"Close"})})]})]}):null};export{ze as default};
//# sourceMappingURL=AttemptReadingModulePage-3e651bf0.js.map
