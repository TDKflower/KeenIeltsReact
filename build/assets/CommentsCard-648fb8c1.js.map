{"version":3,"file":"CommentsCard-648fb8c1.js","sources":["../../src/components/CommentsCard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport {\n  Button,\n  Card,\n  Col,\n  FormControl,\n  InputGroup,\n  Row,\n  Stack,\n} from \"react-bootstrap\";\nimport { FiMessageCircle } from \"react-icons/fi\";\nimport * as Yup from \"yup\";\nimport useAxios from \"../utils/useAxios\";\nimport BaseForm from \"./layout/BaseForm\";\nimport { DJANGO_BASE_URL } from \"../utils/config\";\n\nconst CommentsCard = ({ unique_id, title = \"Comments\", description }) => {\n  const [error, setError] = useState(null);\n  const [comments, setComments] = useState(null);\n\n  const api = useAxios();\n\n  const form_fields = [\n    {\n      type: \"textarea\",\n      label: \"Your Comment\",\n      id: \"comment\",\n      invalid_feedback: \"Add your comment here...\",\n      placeholder: \"Add your comment here...\",\n      value: \"\",\n    },\n  ];\n\n  const CommentsSchema = Yup.object().shape({\n    comment: Yup.string().required(\"Comment is required\"),\n  });\n\n  function getUser() {\n    if (localStorage.getItem(\"authTokens\")) {\n      const user = JSON.parse(localStorage.getItem(\"authTokens\"));\n      return user;\n    }\n    return null;\n  }\n\n  async function getComments() {\n    try {\n      const response = await api.post(\n        DJANGO_BASE_URL + \"/base/get_comments/\" + unique_id + \"/\"\n      );\n      setComments(response.data[\"comments\"]);\n    } catch (error) {\n      console.error(error);\n      setError(error);\n    }\n  }\n\n  async function addComment(values, handleSuccess) {\n    try {\n      // Fetch the current URL\n      const currentUrl = window.location.href;\n\n      // Add the current URL to your values object\n      const dataToSend = {\n        ...values,\n        unique_id: unique_id,\n      };\n\n      // Post request with the updated data\n      const response = await api.post(\n        DJANGO_BASE_URL + \"/base/add_comment/\",\n        dataToSend\n      );\n\n      // Handle Success\n      handleSuccess();\n      getComments();\n    } catch (error) {\n      console.error(error);\n      setError(error);\n    }\n  }\n\n  useEffect(() => {\n    if (getUser()) {\n      getComments();\n    }\n  }, []);\n\n  if (!getUser()) {\n    return null;\n  }\n\n  return (\n    <>\n      <Card>\n        <Card.Header>\n          <Stack direction=\"horizontal\" gap={3}>\n            <div>\n              <h3 className=\"mt-2 fw-bold\">{title}</h3>\n            </div>\n            <div className=\"ms-auto\">\n              <FiMessageCircle size={25} className=\"text-black\" />\n            </div>\n          </Stack>\n        </Card.Header>\n        <Card.Body className=\"border-bottom\">\n          {description && <p>{description}</p>}\n          <BaseForm\n            form_fields={form_fields}\n            form_schema={CommentsSchema}\n            submit_label=\"Post Comment\"\n            successMessage=\"Your comment has been added successfully\"\n            validation_schema={CommentsSchema}\n            on_submit={addComment}\n            resetForm={true}\n            showSuccessMessage={false}\n          />\n        </Card.Body>\n        <div style={{ maxHeight: \"300px\", overflowY: \"auto\" }}>\n          {comments ? (\n            comments.map((comment, index) => (\n              <Card.Body className=\"border-bottom\" key={index}>\n                <Row className=\"d-flex justify-content-between\">\n                  <Col xs={12}>\n                    <p className=\"mb-0\">\n                      <span className=\"fw-bold\">{comment.name}</span> â€¢{\" \"}\n                      {comment.short_date}\n                    </p>\n                    <p className=\"mb-0\">{comment.comment}</p>\n                  </Col>\n                </Row>\n              </Card.Body>\n            ))\n          ) : (\n            <Card.Footer className=\"pt-4 pb-3\">\n              <h4 className=\"text-center\">No comments yet!</h4>\n            </Card.Footer>\n          )}\n        </div>\n      </Card>\n    </>\n  );\n};\n\nexport default CommentsCard;\n"],"names":["CommentsCard","unique_id","title","description","error","setError","useState","comments","setComments","api","useAxios","form_fields","CommentsSchema","Yup.object","Yup.string","getUser","getComments","response","DJANGO_BASE_URL","addComment","values","handleSuccess","currentUrl","dataToSend","useEffect","jsx","Fragment","Card","jsxs","Stack","FiMessageCircle","BaseForm","comment","index","Row","Col"],"mappings":"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"}