import{j as e,h as se,a as M,b as p,k as B,c as l,y as te,z as ne,r as t,i as ie,g as oe,u as ae,A as re,S as le,G as ce,e as de}from"./index-64dfe3ff.js";import{M as ue}from"./MiniNavBar-24e8a789.js";import{C as me}from"./CountdownTimer-eca543e7.js";import{Q as he,g as xe}from"./QuestionPallete-a8356a74.js";import{R as pe,a as fe}from"./ReadingPassage-c2ba9756.js";import{B as je}from"./BookInfo-20f2b86b.js";import{C as we}from"./CustomSplitPane-52ca9ee0.js";import{M as r}from"./Modal-51e54f81.js";import{T as ge}from"./Table-b748b6a9.js";import"./ButtonGroup-e734f25d.js";import"./ParseQuestions-fd192a43.js";const Se=({isExpanded:u,toggleExpanded:f,deviceType:j,module:w,questionData:g,setShowReviewModal:m,userAllAnswer:n,setShowSubmitModal:S,handleConfirmEndTest:i})=>e.jsx("div",{className:"fixed-footer border-top",style:{height:u?"50vh":"50px",width:"100vw",position:"fixed",bottom:0,backgroundColor:"white",transition:"height 0.3s",zIndex:"999"},children:e.jsxs(se,{children:[e.jsxs(M,{className:"mt-1 pb-1 border-bottom text-black",children:[e.jsx(p,{className:"col-4 mt-1",children:e.jsx("div",{children:e.jsxs("span",{style:{fontSize:"20px"},children:[e.jsx(B,{className:"",style:{marginRight:"5px"}}),g.completed_questions,"/",w.total_questions]})})}),e.jsx(p,{className:"col-4 text-center mt-1",children:e.jsx(me,{initialMinutes:40,initialSeconds:0,handleTimesUp:i})}),e.jsxs(p,{className:"col-4",style:{textAlign:"right"},children:[j!=="mobile"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:()=>{m(!0)},children:"Review"}),e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:S,children:"Submit Test"})]}),e.jsx(l,{className:"mx-1",onClick:()=>f(!u),children:u?e.jsx(te,{size:20}):e.jsx(ne,{size:20})})]})]}),e.jsxs(M,{className:"my-3",style:{overflow:"auto",maxHeight:"38vh"},children:[e.jsxs(p,{lg:"8",className:"my-2",children:[e.jsx("p",{className:" fw-bold text-black mb-1 mx-1",children:"Question Pallete"}),e.jsx(he,{module:w,currentFormData:n})]}),e.jsx(p,{lg:"4",children:j==="mobile"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:()=>{m(!0)},children:"Review"}),e.jsx(l,{variant:"outline-primary",className:"mx-1",onClick:S,children:"Submit Test"})]})})]})]})}),Me=()=>{const[u,f]=t.useState("desktop"),[j,w]=t.useState(!1),{module_slug:g,attempt_slug:m}=ie(),[n,S]=t.useState(null),[i,h]=t.useState(null),[be,z]=t.useState({}),[d,P]=t.useState({}),[D,I]=t.useState(null),[x,C]=t.useState({}),[U,q]=t.useState({completed_questions:0}),[H,N]=t.useState(!1),k=()=>N(!1),[L,A]=t.useState(!1),_=()=>A(!1),R=t.useRef(null),T=oe(),[Q,b]=t.useState(!1),v=()=>b(!1),O=ae();t.useRef(null),t.useRef(null);const Y=i?i.id===n.sections[0].id:!1,$=i?i.id===n.sections[n.sections.length-1].id:!1;t.useEffect(()=>{V()},[]),t.useEffect(()=>{if(i){const s=d[i.id];I(s),window.scrollTo(0,0)}},[i]),t.useEffect(()=>{const s=()=>{window.innerWidth<768?f("mobile"):f("desktop")};return s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),t.useEffect(()=>{y(),X()},[n]),t.useEffect(()=>{if(d){let s=0;Object.keys(d).map(o=>Object.keys(d[o]).map(a=>d[o][a]!==void 0&&d[o][a]!==""&&s++)),q({completed_questions:s})}},[d]);function y(){if(i!=null){const s=xe(R,n,z);return P({...d,[i.id]:s}),C({...x,...s}),s}else return null}const G=s=>{s.preventDefault(),ee()},K=s=>{y()};function W(){let o=i.id-1;const a=n.sections.find(c=>c.id===o);if(a)h(a);else{const c=n.sections[n.sections.length-1];h(c)}}function J(){let o=i.id+1;const a=n.sections.find(c=>c.id===o);if(a)h(a);else{const c=n.sections[0];h(c)}}async function V(){const s=await T.post(re.getReadingModule+g+"/");s.status===200&&(S(s.data),h(s.data.sections[0]))}function F(s){const o=n.sections.find(a=>a.id===s);h(o)}function X(){if(n){const s=n.total_questions;let o={};Array.from({length:s},(a,c)=>c+1).map(a=>o["que-"+a]=""),C(o)}}function Z(s="In Progress"){const o={answers:x,attempt_type:s};return T.post("/ieltstest/update_attempt/reading/"+m+"/",o)}function ee(){handleShowModal()}function E(){y(),Z("Completed").then(s=>{s.status===200&&(console.log("Attempt Updated"),O(`/ieltstest/attempt/reading/${g}/${m}/get_result`))}).catch(s=>{console.error("Error updating attempt: ",s)}),v()}return t.useEffect(()=>{document.title="Reading Test | KeenIELTS"},[]),n?e.jsxs(e.Fragment,{children:[e.jsx(ue,{module:n,currentSection:i,updateCurrentSection:F,setShowTestInfoModal:A}),e.jsx(we,{deviceType:u,currentSection:i,left:e.jsx(e.Fragment,{children:e.jsx(pe,{section:i})}),right:e.jsxs(e.Fragment,{children:[e.jsx(fe,{section:i,handleChange:K,handleSubmit:G,formRef:R,section_form_values:D},i.id),e.jsxs(le,{direction:"horizontal",className:"border-top pt-3",children:[e.jsx("div",{className:"m-0",children:e.jsxs(l,{variant:"dark",className:"btn-sm",onClick:W,disabled:Y,children:[e.jsx(ce,{size:20})," Previous Section"]})}),e.jsx("div",{className:"m-0 ms-auto",children:$?e.jsxs(l,{variant:"primary",className:"btn-sm",onClick:()=>{b(!0)},children:["Submit Test ",e.jsx(B,{size:20})]}):e.jsxs(l,{variant:"dark",className:"btn-sm",onClick:J,children:["Next Section ",e.jsx(de,{size:20})]})})]})]})}),e.jsx(Se,{isExpanded:j,toggleExpanded:w,deviceType:u,module:n,updateCurrentSection:F,questionData:U,setShowReviewModal:N,userAllAnswer:x,setShowSubmitModal:b,handleConfirmEndTest:E}),e.jsxs(r,{show:Q,onHide:v,centered:!0,children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"End Test"})}),e.jsx(r.Body,{children:"Are you sure you want to end the test?"}),e.jsxs(r.Footer,{className:"p-2",children:[e.jsx(l,{variant:"outline-primary",onClick:v,children:"No"}),e.jsx(l,{variant:"primary",onClick:E,children:"Yes, end test"})]})]}),e.jsxs(r,{show:H,onHide:k,centered:!0,className:"p-0",children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Review Answers"})}),e.jsx(r.Body,{children:e.jsxs(ge,{striped:!0,bordered:!0,size:"sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Your Answer"})]})}),e.jsx("tbody",{children:Object.keys(x).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.split("-")[1]}),e.jsx("td",{className:"fw-bold text-black",children:x[s]})]},s))})]})}),e.jsx("div",{class:"modal-footer py-2",children:e.jsx("button",{type:"button",class:"btn btn-outline-primary",onClick:k,children:"Close"})})]}),e.jsxs(r,{show:L,onHide:_,centered:!0,className:"p-0",children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Test Info"})}),e.jsx(r.Body,{className:"p-0",children:e.jsx(je,{module:n,attempt_slug:m})}),e.jsx("div",{className:"modal-footer py-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:_,children:"Close"})})]})]}):null};export{Me as default};
//# sourceMappingURL=AttemptReadingModulePage-3c644e53.js.map
