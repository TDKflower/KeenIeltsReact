import{r as n,l as E,E as R,m as g,o as N,n as _,D as k,j as e,C as x,S as B,c as I,p as P,i as O,q as U,h as A,a as p,b as a,A as C}from"./index-9811f83e.js";import{L as $}from"./ListeningSection-cdc9bade.js";import{C as z}from"./CustomAudioPlayer-8df8fca7.js";import{R as D}from"./ReviewAnswers-05436183.js";import{O as F}from"./OverallBandsCard-6ba24daa.js";import{F as H}from"./FullTestNextModule-ab35988b.js";import{W as K}from"./WhatsNextCard-591b17ed.js";import{S as M}from"./StartPracticeTestCard-dfbad068.js";import{C as q}from"./CommentsCard-40f04ac9.js";import{T as v}from"./Table-77480f4b.js";import{A as c}from"./Accordion-dc14098b.js";import"./ParseQuestions-55868799.js";import"./Modal-33aaf3c1.js";const w=k,W=()=>{const{authTokens:t,setUser:l,setAuthTokens:u}=n.useContext(E),[r,j]=n.useContext(R),i=g.create({baseURL:w,headers:{Authorization:`Bearer ${t==null?void 0:t.access}`}});return i.interceptors.request.use(async m=>{try{const o=N(t.access);if(!(_.unix(o.exp).diff(_())<1))return m;const d=await g.post(`${w}/account/token/refresh/`,{refresh:t.refresh});return localStorage.setItem("authTokens",JSON.stringify(d.data)),u(d.data),l(N(d.data.access)),m.headers.Authorization=`Bearer ${d.data.access}`,m}catch(o){return console.error("Error:",o),j("Something went wrong. Please refresh the page and try again. If the problem persists, contact team@keenielts.com."),Promise.reject(o)}}),i},J=({attempt:t,module_type:l})=>e.jsxs(x,{children:[e.jsxs(x.Header,{className:`bg-${l} py-2 text-white fw-bold text-capitalize`,children:[l," Test Result"]}),e.jsx(x.Header,{children:e.jsxs(B,{direction:"horizontal",gap:1,children:[e.jsx("div",{children:e.jsx("h3",{className:"mt-2 fw-bold",children:t.user_test_info.name})}),e.jsx("div",{className:"ms-auto",children:e.jsx(I,{variant:"outline-primary",size:"sm",children:"Share"})})]})}),e.jsx("div",{className:"table-responsive",children:e.jsx(v,{className:"table-striped table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Test Date"}),e.jsx("td",{children:t.user_test_info.created_at})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Book"}),e.jsx("td",{children:t.user_test_info.book})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Test"}),e.jsx("td",{children:t.user_test_info.test})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Test ID"}),e.jsx("td",{children:t.slug})]})]})})}),e.jsx(x.Footer,{children:e.jsx("div",{className:"sharethis-inline-share-buttons"})})]}),y="listening",ie=()=>{const t=P();W();const{module_slug:l,attempt_slug:u}=O(),[r,j]=n.useState(null),[i,m]=n.useState(null),[o,f]=n.useState(null);n.useContext(U);async function d(){const s=await t.post(C.getListeningAttempt+u+"/");s.status===200?j(s.data):console.error("Unable to fetch attempt at ListeningResult.jsx")}async function S(){const s=await t.post(C.getListeningModule+l+"/");s.status===200&&m(s.data)}if(n.useEffect(()=>{d(),S()},[]),n.useEffect(()=>{document.title="Listening Test Result  | KeenIELTS"},[]),!i||!r||!r.evaluation)return null;function T(s){f(s.audio_start_time)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx(A,{children:e.jsx(p,{className:"justify-content-center",children:e.jsx(a,{xl:8,lg:10,md:12,className:"",children:e.jsx(J,{attempt:r,module_type:y})})})})}),e.jsx("div",{className:"mb-4",children:e.jsx(A,{children:e.jsxs(p,{className:"justify-content-center",children:[e.jsx(a,{xl:8,lg:10,md:12,className:"mt-3 mb-3",children:e.jsx(F,{bands:r.bands,description:r.bands_description,color:"listening"})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(x,{children:e.jsx(x.Body,{className:"m-0 p-1",children:e.jsx(z,{src:i.audio,start_time:o})})})}),e.jsx(a,{xl:8,lg:10,md:12,children:e.jsxs(c,{defaultActiveKey:"0",children:[e.jsxs(c.Item,{eventKey:"0",children:[e.jsx(c.Header,{children:e.jsx("span",{className:"text-black fw-bold",children:"Review Answers"})}),e.jsx(c.Body,{className:"p-0 m-0",children:e.jsx(D,{attempt:r})})]}),Object.entries(r.evaluation.all_sections).map((s,b)=>e.jsxs(c.Item,{eventKey:b+1,children:[e.jsx(c.Header,{children:e.jsxs("span",{className:"text-black fw-bold",children:["Section ",b+1," â€¢ ",s[1].correct,"/",s[1].correct+s[1].incorrect]})}),e.jsx(c.Body,{className:"p-0 m-0",children:e.jsxs(v,{bordered:!0,className:"table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Your Answer"}),e.jsx("th",{scope:"col",children:"Correct Answer"})]})}),e.jsx("tbody",{children:Object.entries(s[1]).map((h,L)=>h[0].split("-")[0]==="que"?e.jsxs("tr",{className:h[1].is_user_answer_correct===!0?"table-success":"table-danger",children:[e.jsx("td",{className:"fw-bold",children:h[0].split("-")[1]}),e.jsx("td",{className:"text-black",children:h[1].user_answer}),e.jsx("td",{className:"text-black",children:h[1].correct_answer})]},L):null)})]})})]},s[0]))]})}),e.jsx(a,{xl:8,lg:10,md:12,className:"",children:e.jsx(p,{children:i.sections.length>0&&i.sections.map(s=>e.jsx("div",{className:"mt-3",children:e.jsx($,{section:s,user_answers:r.evaluation.all_questions,setCurrentSection:T})},s.id))})}),r.full_test_next_attempt&&e.jsx(a,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(H,{attempt:r})}),e.jsx(a,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(K,{})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(M,{})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(q,{unique_id:`${y}-${l}`})})]})})})]})};export{ie as default};
//# sourceMappingURL=ListeningResultPage-a43c85c6.js.map
