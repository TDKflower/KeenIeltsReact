import{r as n,k as E,E as R,l as f,o as g,m as b,D as v,f as T,h as k,n as P,j as e,g as B,a as A,b as a,C as N,A as C}from"./index-e388c6e0.js";import{P as I}from"./PageHeadingBriefInfo-7db9b2af.js";import{L as O}from"./ListeningSection-f86f9460.js";import{C as U}from"./CustomAudioPlayer-0fd6ea44.js";import{R as $}from"./ReviewAnswers-bb484f2d.js";import{O as K}from"./OverallBandsCard-2208d4b4.js";import{F as M}from"./FullTestNextModule-926c7b77.js";import{W as F}from"./WhatsNextCard-342151c9.js";import{S as H}from"./StartPracticeTestCard-a1615501.js";import{C as W}from"./CommentsCard-c23cf8ad.js";import{A as i}from"./Accordion-5bf38b68.js";import{T as q}from"./Table-7d0efeb1.js";import"./ParseQuestions-9abdb19d.js";import"./Modal-33d57697.js";const _=v,z=()=>{const{authTokens:o,setUser:x,setAuthTokens:m}=n.useContext(E),[h,t]=n.useContext(R),u=f.create({baseURL:_,headers:{Authorization:`Bearer ${o==null?void 0:o.access}`}});return u.interceptors.request.use(async r=>{try{const l=g(o.access);if(!(b.unix(l.exp).diff(b())<1))return r;const c=await f.post(`${_}/account/token/refresh/`,{refresh:o.refresh});return localStorage.setItem("authTokens",JSON.stringify(c.data)),m(c.data),x(g(c.data.access)),r.headers.Authorization=`Bearer ${c.data.access}`,r}catch(l){return console.error("Error:",l),t("Something went wrong. Please refresh the page and try again. If the problem persists, contact team@keenielts.com."),Promise.reject(l)}}),u},D="listening",ie=()=>{const o=T(),x=z(),{module_slug:m,attempt_slug:h}=k(),[t,u]=n.useState(null),[r,l]=n.useState(null),[p,c]=n.useState(null);n.useContext(P);async function y(){const s=await o.post(C.getListeningAttempt+h+"/");s.status===200?u(s.data):console.error("Unable to fetch attempt at ListeningResult.jsx")}async function w(){const s=await x.post(C.getListeningModule+m+"/");s.status===200&&l(s.data)}if(n.useEffect(()=>{y(),w()},[]),n.useEffect(()=>{document.title="Listening Test Result  | KeenIELTS"},[]),!r||!t||!t.evaluation)return null;function L(s){c(s.audio_start_time)}return e.jsxs(e.Fragment,{children:[e.jsx(I,{pagetitle:t.book.name,briefinfo:"Listening Test Result",color:"bg-listening"}),e.jsx("div",{className:"my-4",children:e.jsx(B,{children:e.jsxs(A,{className:"justify-content-center",children:[e.jsx(a,{xl:8,lg:10,md:12,className:"mt-3 mb-3",children:e.jsx(K,{bands:t.bands,description:t.bands_description,color:"listening"})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(N,{children:e.jsx(N.Body,{className:"m-0 p-1",children:e.jsx(U,{src:r.audio,start_time:p})})})}),e.jsx(a,{xl:8,lg:10,md:12,children:e.jsxs(i,{defaultActiveKey:"0",children:[e.jsxs(i.Item,{eventKey:"0",children:[e.jsx(i.Header,{children:e.jsx("span",{className:"text-black fw-bold",children:"Review Answers"})}),e.jsx(i.Body,{className:"p-0 m-0",children:e.jsx($,{attempt:t})})]}),Object.entries(t.evaluation.all_sections).map((s,j)=>e.jsxs(i.Item,{eventKey:j+1,children:[e.jsx(i.Header,{children:e.jsxs("span",{className:"text-black fw-bold",children:["Section ",j+1," â€¢ ",s[1].correct,"/",s[1].correct+s[1].incorrect]})}),e.jsx(i.Body,{className:"p-0 m-0",children:e.jsxs(q,{bordered:!0,className:"table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Your Answer"}),e.jsx("th",{scope:"col",children:"Correct Answer"})]})}),e.jsx("tbody",{children:Object.entries(s[1]).map((d,S)=>d[0].split("-")[0]==="que"?e.jsxs("tr",{className:d[1].is_user_answer_correct===!0?"table-success":"table-danger",children:[e.jsx("td",{className:"fw-bold",children:d[0].split("-")[1]}),e.jsx("td",{className:"text-black",children:d[1].user_answer}),e.jsx("td",{className:"text-black",children:d[1].correct_answer})]},S):null)})]})})]},s[0]))]})}),e.jsx(a,{xl:8,lg:10,md:12,className:"",children:e.jsx(A,{children:r.sections.length>0&&r.sections.map(s=>e.jsx("div",{className:"mt-3",children:e.jsx(O,{section:s,user_answers:t.evaluation.all_questions,setCurrentSection:L})},s.id))})}),t.full_test_next_attempt&&e.jsx(a,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(M,{attempt:t})}),e.jsx(a,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(F,{})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(H,{})}),e.jsx(a,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(W,{unique_id:`${D}-${m}`})})]})})})]})};export{ie as default};
//# sourceMappingURL=ListeningResultPage-2aa902ad.js.map
