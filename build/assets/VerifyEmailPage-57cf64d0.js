import{a5 as T,r as a,t as q,u as R,k as f,a1 as h,a2 as y,a6 as k,j as e,g as A,a as N,b as C,a4 as x,D as p}from"./index-e388c6e0.js";import{A as r}from"./Accordion-5bf38b68.js";const K=()=>{const n=T(),[o,b]=a.useState(""),c=q(),[d,m]=a.useState(null),u=R();let{registerUser:V,registrationError:B,user:g}=a.useContext(f);const[v,l]=a.useState("0"),{loginUserWithToken:E}=a.useContext(f);a.useEffect(()=>{const i=new URLSearchParams(n.search).get("email");i&&b(i)},[n]),a.useEffect(()=>{g&&u("/")},[]);const j=[{type:"email",label:"Email",id:"email",invalid_feedback:"e.g. yourname@gmail.com",placeholder:"Enter your Email Address",value:o},{type:"number",label:"OTP",id:"otp",invalid_feedback:"e.g. 123456",placeholder:"Enter OTP"}],_=[{type:"email",label:"Email",id:"email",invalid_feedback:"e.g. yourname@gmail.com",placeholder:"Enter your Email Address",value:o}],P=h().shape({email:y().email("Invalid email").required("Required"),otp:k().required("Required").required("Required").min(1e5,"OTP must be 6 digits").max(999999,"OTP must be 6 digits")}),w=h().shape({email:y().email("Invalid email").required("Required")}),O=async(t,i)=>{try{const s=await c.post(p+"/account/verify_email/",t);s.data.token&&(E(s.data.token),i(),u("/"))}catch(s){console.error("Error verifying email:",s),m(s.response.data.message)}},S=async(t,i)=>{try{const s=await c.post(p+"/account/send_verify_email/",t);i(),l("0")}catch(s){console.error("Error fetching data:",s),m(s.response.data.message)}};return e.jsx(e.Fragment,{children:e.jsx(A,{className:"mb-5",children:e.jsx(N,{className:"align-items-center justify-content-center mt-5",children:e.jsx(C,{lg:5,md:8,className:"",children:e.jsxs(r,{activeKey:v,children:[e.jsxs(r.Item,{eventKey:"0",onClick:()=>l("0"),children:[e.jsxs(r.Header,{children:[" ",e.jsx("h4",{className:"mt-2 fw-bold",children:"Verify Email"})]}),e.jsxs(r.Body,{children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{children:"We have sent you an email with a OTP to verify your email address. Please enter your email address and the OTP below."})}),e.jsx(x,{form_fields:j,submit_label:"Verify",validation_schema:P,on_submit:O,nonFieldErrors:d,successMessage:"Verification Successful"})]})]}),e.jsxs(r.Item,{eventKey:"1",onClick:()=>l("1"),children:[e.jsxs(r.Header,{children:[" ",e.jsx("h4",{className:"mt-2 fw-bold",children:"Resend OTP"})]}),e.jsxs(r.Body,{children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{children:"We will send you an email with a OTP to verify your email, please enter your email address below."})}),e.jsx(x,{form_fields:_,submit_label:"Send OTP",validation_schema:w,on_submit:S,nonFieldErrors:d,successMessage:"Code Sent Successful"})]})]})]})})})})})};export{K as default};
//# sourceMappingURL=VerifyEmailPage-57cf64d0.js.map
