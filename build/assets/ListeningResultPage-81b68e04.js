import{r as n,l as v,E,m as g,o as b,n as N,D as R,p as I,i as P,q as k,j as e,h as A,a as j,b as r,C,A as _}from"./index-0dfab423.js";import{L as B}from"./ListeningSection-e52be41d.js";import{C as U}from"./CustomAudioPlayer-6a748466.js";import{R as O}from"./ReviewAnswers-0d577792.js";import{O as $}from"./OverallBandsCard-44185830.js";import{U as K,T as M,F as q}from"./TestReactionCard-4e409cde.js";import{W as F}from"./WhatsNextCard-f484b626.js";import{S as W}from"./StartPracticeTestCard-1943c21c.js";import{C as z}from"./CommentsCard-5db4022b.js";import{A as c}from"./Accordion-0e7c5a28.js";import{T as D}from"./Table-d62bb417.js";import"./ParseQuestions-adcc3e2b.js";import"./Modal-adf2be80.js";const y=R,H=()=>{const{authTokens:a,setUser:x,setAuthTokens:u}=n.useContext(v),[t,h]=n.useContext(E),l=g.create({baseURL:y,headers:{Authorization:`Bearer ${a==null?void 0:a.access}`}});return l.interceptors.request.use(async d=>{try{const o=b(a.access);if(!(N.unix(o.exp).diff(N())<1))return d;const i=await g.post(`${y}/account/token/refresh/`,{refresh:a.refresh});return localStorage.setItem("authTokens",JSON.stringify(i.data)),u(i.data),x(b(i.data.access)),d.headers.Authorization=`Bearer ${i.data.access}`,d}catch(o){return console.error("Error:",o),h("Something went wrong. Please refresh the page and try again. If the problem persists, contact team@keenielts.com."),Promise.reject(o)}}),l},w="listening",le=()=>{const a=I();H();const{module_slug:x,attempt_slug:u}=P(),[t,h]=n.useState(null),[l,d]=n.useState(null),[o,p]=n.useState(null);n.useContext(k);async function i(){const s=await a.post(_.getListeningAttempt+u+"/");s.status===200?h(s.data):console.error("Unable to fetch attempt at ListeningResult.jsx")}async function S(){const s=await a.post(_.getListeningModule+x+"/");s.status===200&&d(s.data)}if(n.useEffect(()=>{i(),S()},[]),n.useEffect(()=>{document.title="Listening Test Result  | KeenIELTS"},[]),!l||!t||!t.evaluation)return null;function L(s){p(s.audio_start_time)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx(A,{children:e.jsx(j,{className:"justify-content-center",children:e.jsx(r,{xl:8,lg:10,md:12,className:"",children:e.jsx(K,{attempt:t,module_type:w})})})})}),e.jsx("div",{className:"mb-4",children:e.jsx(A,{children:e.jsxs(j,{className:"justify-content-center",children:[e.jsx(r,{xl:8,lg:10,md:12,className:"mt-3 mb-3",children:e.jsx($,{bands:t.bands,description:t.bands_description,color:"listening"})}),e.jsx(r,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(C,{children:e.jsx(C.Body,{className:"m-0 p-1",children:e.jsx(U,{src:l.audio,start_time:o})})})}),e.jsx(r,{xl:8,lg:10,md:12,children:e.jsxs(c,{defaultActiveKey:"0",children:[e.jsxs(c.Item,{eventKey:"0",children:[e.jsx(c.Header,{children:e.jsx("span",{className:"text-black fw-bold",children:"Review Answers"})}),e.jsx(c.Body,{className:"p-0 m-0",children:e.jsx(O,{attempt:t})})]}),Object.entries(t.evaluation.all_sections).map((s,f)=>e.jsxs(c.Item,{eventKey:f+1,children:[e.jsx(c.Header,{children:e.jsxs("span",{className:"text-black fw-bold",children:["Section ",f+1," â€¢ ",s[1].correct,"/",s[1].correct+s[1].incorrect]})}),e.jsx(c.Body,{className:"p-0 m-0",children:e.jsxs(D,{bordered:!0,className:"table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Your Answer"}),e.jsx("th",{scope:"col",children:"Correct Answer"})]})}),e.jsx("tbody",{children:Object.entries(s[1]).map((m,T)=>m[0].split("-")[0]==="que"?e.jsxs("tr",{className:m[1].is_user_answer_correct===!0?"table-success":"table-danger",children:[e.jsx("td",{className:"fw-bold",children:m[0].split("-")[1]}),e.jsx("td",{className:"text-black",children:m[1].user_answer}),e.jsx("td",{className:"text-black",children:m[1].correct_answer})]},T):null)})]})})]},s[0]))]})}),e.jsx(r,{xl:8,lg:10,md:12,className:"",children:e.jsx(j,{children:l.sections.length>0&&l.sections.map(s=>e.jsx("div",{className:"mt-3",children:e.jsx(B,{section:s,user_answers:t.evaluation.all_questions,setCurrentSection:L})},s.id))})}),e.jsx(r,{xl:8,lg:10,md:12,className:"mt-3",children:e.jsx(M,{})}),t.full_test_next_attempt&&e.jsx(r,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(q,{attempt:t})}),e.jsx(r,{xl:8,lg:10,md:12,className:"my-3",children:e.jsx(F,{})}),e.jsx(r,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(W,{})}),e.jsx(r,{xl:8,lg:10,md:12,className:"mb-3",children:e.jsx(z,{unique_id:`${w}-${x}`})})]})})})]})};export{le as default};
//# sourceMappingURL=ListeningResultPage-81b68e04.js.map
