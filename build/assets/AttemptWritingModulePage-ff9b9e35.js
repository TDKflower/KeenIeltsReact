import{j as e,H as T,x as H,B as U,h as $,a as q,b as k,c as f,G,k as K,e as Y,g as J,i as O,r as i,u as Q,A as V}from"./index-de900e16.js";import{M as X}from"./MiniNavBar-baed3ede.js";import{B as Z}from"./BookInfo-e84fe088.js";/* empty css                      */import{C as ee}from"./CountdownTimer-6ba890f2.js";import{F as te}from"./FontSizeSlider-d03d9414.js";import{C as se}from"./CustomSplitPane-6256b20f.js";import{M as d}from"./Modal-a2fdd4fc.js";import"./ButtonGroup-fcd12b84.js";import"./Table-7167a013.js";const ne=({currentSection:o,deviceType:m,formRef:u,handleChange:n,currentFormData:x,userAnswerBySection:t})=>{const a=h=>h?h.trim().split(/\s+/).length:0,p=t[o.id]||"";return e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"writing-questions mb-2",ref:u,children:[T(o.questions),e.jsx(H.Control,{as:"textarea",rows:m==="mobile"?10:30,placeholder:"Write your answer here",name:`task-${o.id}`,value:p,onChange:n})]}),e.jsx("div",{style:{textAlign:"right"},children:e.jsxs(U,{className:"bg-dark mb-3",children:["Word Count: ",a(p)]})})]})},ie=({currentSection:o})=>e.jsxs("div",{children:[" ",T(o.task)]}),oe=({deviceType:o,handleConfirmEndTest:m,isFirstSection:u,isLastSection:n,handleNextSectionButton:x,handlePreviousSectionButton:t,setShowSubmitModal:a})=>e.jsx("div",{className:"fixed-footer border-top",style:{height:"50px",width:"100vw",position:"fixed",bottom:0,backgroundColor:"white",transition:"height 0.3s",zIndex:"999"},children:e.jsx($,{children:e.jsxs(q,{className:"mt-1 text-black",children:[e.jsx(k,{className:"col-4 mt-1",children:e.jsx(ee,{initialMinutes:60,initialSeconds:0,handleTimesUp:m})}),o==="desktop"&&e.jsx(k,{className:"col-3 mt-1",style:{textAlign:"center"},children:e.jsx(te,{})}),e.jsxs(k,{className:"col mt-1 mx-auto",style:{textAlign:"right"},children:[e.jsxs(f,{variant:"dark",className:"btn-sm mx-2",onClick:t,disabled:u,children:[e.jsx(G,{size:20})," ",o!=="mobile"&&"Previous Task"]}),n?e.jsxs(f,{variant:"primary",className:"btn-sm",onClick:()=>{a(!0)},children:["Submit Test ",e.jsx(K,{size:20})]}):e.jsxs(f,{variant:"dark",className:"btn-sm",onClick:x,children:["Next Task ",e.jsx(Y,{size:20})]})]})]})})}),pe=()=>{const o=J(),{module_slug:m,attempt_slug:u}=O(),[n,x]=i.useState(null),[t,a]=i.useState(null),[p,h]=i.useState(!1),b=()=>h(!1),[j,v]=i.useState("desktop"),[g,_]=i.useState({}),w=i.useRef(null),[F,M]=i.useState({}),A=t?t.id===n.sections[0].id:!1,E=t?t.id===n.sections[n.sections.length-1].id:!1,[B,y]=i.useState(!1),S=()=>y(!1),W=Q();async function I(){const s=await o.post(V.getWritingModule+m+"/");s.status===200&&(x(s.data),a(s.data.sections[0]))}function z(s){const r=n.sections.find(c=>c.id===s);a(r)}function L(s="In Progress"){const r={answers:g,attempt_type:s};return o.post("/ieltstest/update_attempt/writing/"+u+"/",r)}function N(){C(),L("Completed").then(s=>{s.status===200&&(console.log("Attempt Updated"),W(`/ieltstest/attempt/writing/${m}/${u}/get_result`))}).catch(s=>{console.error("Error updating attempt: ",s)}),S()}function P(){let r=t.id-1;const c=n.sections.find(l=>l.id===r);if(c)a(c);else{const l=n.sections[n.sections.length-1];a(l)}}function R(){let r=t.id+1;const c=n.sections.find(l=>l.id===r);if(c)a(c);else{const l=n.sections[0];a(l)}}i.useEffect(()=>{const s=()=>{window.innerWidth<768?v("mobile"):v("desktop")};return s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]);const D=s=>{C()};function C(){if(w.current){const s=new FormData(w.current);let r={};for(let[c,l]of s.entries())r[c]=l;_({...g,[t.id]:r[`task-${t.id}`]}),M(r)}}return i.useEffect(()=>{t&&window.scrollTo(0,0)},[t]),i.useEffect(()=>{C()},[t]),i.useEffect(()=>{I()},[]),i.useEffect(()=>{document.title="Writing Test | KeenIELTS"},[]),n?e.jsxs(e.Fragment,{children:[e.jsx(X,{module:n,currentSection:t,updateCurrentSection:z,setShowTestInfoModal:h}),e.jsx(se,{deviceType:j,currentSection:t,left:e.jsx(ie,{currentSection:t},t.id),right:e.jsx(ne,{currentSection:t,deviceType:j,formRef:w,handleChange:D,currentFormData:F,userAnswerBySection:g},t.id)}),e.jsx(oe,{deviceType:j,handleConfirmEndTest:N,isFirstSection:A,isLastSection:E,handleNextSectionButton:R,handlePreviousSectionButton:P,setShowSubmitModal:y}),e.jsxs(d,{show:B,onHide:S,centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"End Test"})}),e.jsx(d.Body,{children:"Are you sure you want to end the test?"}),e.jsxs(d.Footer,{className:"p-2",children:[e.jsx(f,{variant:"outline-primary",onClick:S,children:"No"}),e.jsx(f,{variant:"primary",onClick:N,children:"Yes, end test"})]})]}),e.jsxs(d,{show:p,onHide:b,centered:!0,className:"p-0",children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Test Info"})}),e.jsx(d.Body,{className:"p-0",children:e.jsx(Z,{module:n,attempt_slug:u})}),e.jsx("div",{className:"modal-footer py-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:b,children:"Close"})})]})]}):null};export{pe as default};
//# sourceMappingURL=AttemptWritingModulePage-ff9b9e35.js.map
